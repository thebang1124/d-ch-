
<!DOCTYPE html>
<html lang="vi" class="dark">
<head>
  <meta charset="UTF-8" />
  <title>Dịch Việt ↔ Ê-đê - Final v3</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js"></script>
  <script>tailwind.config = { darkMode: 'class' };</script>
  <style>
    @font-face {
      font-family: 'CharisSIL';
      src: url('https://cdn.jsdelivr.net/gh/silnrsi/font-charis@main/web/CharisSIL-Regular.woff2') format('woff2');
    }
    body { font-family: 'CharisSIL', serif; }
  </style>
</head>
<body class="dark:bg-gray-900 dark:text-white text-black bg-white p-4">
  <div class="max-w-4xl mx-auto space-y-6">

    <h1 class="text-2xl font-bold">Dịch Việt ↔ Ê‑đê</h1>

    <!-- Input & Translation -->
    <input id="inputText" placeholder="Nhập từ..." class="w-full p-2 bg-gray-100 dark:bg-gray-800 rounded" />
    <button onclick="translate()" class="px-4 py-2 bg-blue-600 text-white rounded">Dịch</button>
    <textarea id="outputText" rows="2" class="w-full p-2 bg-gray-200 dark:bg-gray-700 rounded" readonly></textarea>

    <!-- OCR -->
    <div>
      <h2 class="font-semibold">📷 OCR Đa Ảnh</h2>
      <input type="file" multiple accept="image/*" onchange="handleOCR(this.files)" />
      <pre id="ocrOutput" class="bg-gray-100 dark:bg-gray-800 p-2 rounded mt-2 text-sm whitespace-pre-wrap"></pre>
    </div>

    <!-- Flashcard -->
    <div>
      <h2 class="font-semibold">🎴 Flashcard luyện từ</h2>
      <button onclick="showFlashcard()" class="text-sm bg-green-600 text-white px-3 py-1 rounded">Luyện tập</button>
      <div id="flashcard" class="mt-2 p-2 border rounded dark:border-gray-700"></div>
    </div>

    <!-- AI Mô phỏng -->
    <div>
      <h2 class="font-semibold">🧠 AI Giải thích (mô phỏng)</h2>
      <button onclick="mockAIExplain()" class="text-sm bg-purple-600 text-white px-3 py-1 rounded">Giải thích từ</button>
      <div id="aiExplain" class="mt-2 text-sm italic"></div>
    </div>

    <!-- Tác giả -->
    <p class="text-xs pt-6 text-gray-400">Ứng dụng được phát triển bởi <strong>Thế Bằng</strong> © 2025</p>
  </div>

  <script>
    const dictEV = { "abă": "cha", "abăn": "xoa dịu", "amâo": "lửa" };
    const dictVE = { "cha": "abă", "xoa dịu": "abăn", "lửa": "amâo" };

    function translate() {
      const input = document.getElementById("inputText").value.trim().toLowerCase();
      const output = dictEV[input] || dictVE[input] || `(tra mạng: ${input})`;
      document.getElementById("outputText").value = output;
    }

    function handleOCR(files) {
      document.getElementById("ocrOutput").textContent = "Đang xử lý ảnh...";
      let results = [];
      Array.from(files).forEach((file, index) => {
        Tesseract.recognize(file, 'vie', {
          logger: m => console.log(`[OCR ${index + 1}]`, m)
        }).then(({ data: { text } }) => {
          results.push(`🖼 Ảnh ${index + 1}:
${text.trim()}`);
          document.getElementById("ocrOutput").textContent = results.join("\n\n");
        });
      });
    }

    function showFlashcard() {
      const keys = Object.keys(dictVE);
      const random = keys[Math.floor(Math.random() * keys.length)];
      document.getElementById("flashcard").innerText = `👉 ${random} = ${dictVE[random]}`;
    }

    function mockAIExplain() {
      const word = document.getElementById("inputText").value.trim().toLowerCase();
      const meaning = dictEV[word] || dictVE[word];
      const explanation = meaning
        ? `Từ "${word}" có nghĩa là "${meaning}". Đây là một từ đơn giản trong tiếng Ê-đê/Việt.`
        : `Không tìm thấy từ "${word}". Vui lòng kiểm tra lại hoặc tra trên internet.`;
      document.getElementById("aiExplain").innerText = explanation;
    }
  </script>
</body>
</html>
